---
title: 'ZarzÄ…dzanie uÅ¼ytkownikami w systemie ATP'
description: 'Kompleksowy przewodnik po zarzÄ…dzaniu uÅ¼ytkownikami, rolami i sesjami w systemie ATP System'
category: 'Development'
version: '1.0.0'
lastUpdated: '2025-05-28'
createdAt: '2025-04-18'
author: 'ZespÃ³Å‚ deweloperski ATP'
requiredRole: ['admin', 'manager', 'developer']
icon: 'i-heroicons-users'
tags: ['uÅ¼ytkownicy', 'role', 'rejestracja', 'sesje', 'bezpieczeÅ„stwo']
status: 'published'
difficulty: 'intermediate'
readingTime: 12
docType: 'guide'
navigation:
  title: 'ZarzÄ…dzanie uÅ¼ytkownikami'
  icon: 'i-heroicons-users'
  order: 3
related: ['session-management', 'api', 'architektura']
---

# ZarzÄ…dzanie uÅ¼ytkownikami w systemie ATP

::alert{type="info"}
System ATP posiada zaawansowany system zarzÄ…dzania uÅ¼ytkownikami z 7 rÃ³Å¼nymi rolami, elastycznÄ… rejestracjÄ… oraz kompleksowym zarzÄ…dzaniem sesjami wielourzÄ…dzeniowymi.
::

## ğŸ›¡ï¸ System rÃ³l uÅ¼ytkownikÃ³w

System ATP System implementuje 7 podstawowych rÃ³l uÅ¼ytkownikÃ³w zdefiniowanych w `shared/utils/roles.constants.ts`:

::list{type="success"}
- **ADMIN** - PeÅ‚ne uprawnienia administracyjne
- **MANAGER** - ZarzÄ…dzanie projektami i zespoÅ‚ami  
- **COACH** - Funkcje trenerskie i zarzÄ…dzanie sportowcami
- **ATHLETE** - DostÄ™p sportowca do treningÃ³w i statystyk
- **EDITOR** - Tworzenie i edycja treÅ›ci
- **USER** - Podstawowy uÅ¼ytkownik systemu (rola domyÅ›lna)
- **OBSERVER** - Ograniczony dostÄ™p tylko do odczytu
::

## ğŸ‘¥ Model hybrydowy rejestracji uÅ¼ytkownikÃ³w

System ATP implementuje elastyczny model hybrydowy, ktÃ³ry umoÅ¼liwia rÃ³Å¼ne Å›cieÅ¼ki tworzenia kont w zaleÅ¼noÅ›ci od typu uÅ¼ytkownika i potrzeb organizacji.

### 1. Rejestracja samodzielna uÅ¼ytkownikÃ³w

System posiada w peÅ‚ni funkcjonalny endpoint rejestracji (`/api/auth/register`) ktÃ³ry obsÅ‚uguje:

::list{type="success"}
- **Automatyczna weryfikacja danych**: Walidacja email, hasÅ‚a i wymaganych pÃ³l
- **DomyÅ›lna rola USER**: Nowo zarejestrowani uÅ¼ytkownicy otrzymujÄ… rolÄ™ `USER`
- **Weryfikacja email**: Opcjonalny proces potwierdzenia adresu email
- **ZgodnoÅ›Ä‡ prawna**: MoÅ¼liwoÅ›Ä‡ implementacji akceptacji regulaminÃ³w
- **Bezpieczne hashowanie haseÅ‚**: Wykorzystanie bcrypt do ochrony haseÅ‚
::

**Implementacja**: Endpoint dostÄ™pny w `server/api/auth/register.post.ts`

### 2. Tworzenie uÅ¼ytkownikÃ³w przez administratorÃ³w

Administratorzy z rolÄ… `ADMIN` lub `MANAGER` mogÄ… tworzyÄ‡ konta dla:

::list{type="warning"}
- **TrenerÃ³w (COACH)**: Z peÅ‚nymi uprawnieniami trenarskimi
- **ManagerÃ³w**: Do zarzÄ…dzania projektami i zespoÅ‚ami  
- **EdytorÃ³w**: Do zarzÄ…dzania treÅ›ciÄ… systemu
- **Innych administratorÃ³w**: Delegowanie uprawnieÅ„ administracyjnych
- **ObserwatorÃ³w**: Konta z ograniczonym dostÄ™pem tylko do odczytu
::

**ZarzÄ…dzanie rolami**: Implementowane przez `server/utils/repositories/user_roles.repositories.ts`

### 3. Tworzenie uÅ¼ytkownikÃ³w przez trenerÃ³w

Trenerzy z rolÄ… `COACH` majÄ… moÅ¼liwoÅ›Ä‡:

::list{type="info"}
- **Tworzenia kont dla sportowcÃ³w**: Ograniczone do roli `ATHLETE`
- **ZarzÄ…dzania swoimi podopiecznymi**: PeÅ‚na kontrola nad przypisanymi sportowcami
- **Delegowania uprawnieÅ„**: Sportowcy mogÄ… dokoÅ„czyÄ‡ proces rejestracji samodzielnie
- **Monitorowania aktywnoÅ›ci**: Åšledzenie sesji i aktywnoÅ›ci swoich sportowcÃ³w
::

## âœ… Zalety zaimplementowanego rozwiÄ…zania

::list{type="success"}
- **ElastycznoÅ›Ä‡ dostÄ™pu**: RÃ³Å¼ne Å›cieÅ¼ki rejestracji dla rÃ³Å¼nych grup uÅ¼ytkownikÃ³w
- **BezpieczeÅ„stwo wielowarstwowe**: Kontrola uprawnieÅ„ na poziomie rÃ³l i sesji
- **SkalowalnoÅ›Ä‡**: System rÃ³l pozwala na Å‚atwe dodawanie nowych typÃ³w uÅ¼ytkownikÃ³w
- **Wygoda zarzÄ…dzania**: Trenerzy mogÄ… samodzielnie dodawaÄ‡ swoich sportowcÃ³w
- **Compliance**: MoÅ¼liwoÅ›Ä‡ implementacji wymagaÅ„ prawnych i regulaminowych
- **Monitorowanie aktywnoÅ›ci**: PeÅ‚ne Å›ledzenie sesji i aktywnoÅ›ci uÅ¼ytkownikÃ³w
::

## ğŸ“± ZarzÄ…dzanie sesjami uÅ¼ytkownikÃ³w

System ATP posiada zaawansowany system zarzÄ…dzania sesjami wielourzÄ…dzeniowymi, ktÃ³ry automatycznie integruje siÄ™ z systemem rÃ³l i uprawnieÅ„ uÅ¼ytkownikÃ³w.

### Kluczowe funkcjonalnoÅ›ci

::alert{type="success"}
**DostÄ™p**: FunkcjonalnoÅ›Ä‡ dostÄ™pna dla wszystkich uÅ¼ytkownikÃ³w na `/dashboard/sessions`
::

::list{type="info"}
- **Monitoring sesji**: PrzeglÄ…d wszystkich aktywnych sesji z informacjami o urzÄ…dzeniach
- **ZarzÄ…dzanie dostÄ™pem**: Wylogowanie z pojedynczych urzÄ…dzeÅ„ lub wszystkich naraz
- **Wykrywanie urzÄ…dzeÅ„**: Automatyczne rozpoznawanie typu urzÄ…dzenia i przeglÄ…darki
- **Lokalizacja geograficzna**: PrzybliÅ¼ona lokalizacja na podstawie adresu IP
- **Statystyki bezpieczeÅ„stwa**: Dashboard z liczbÄ… aktywnych sesji i urzÄ…dzeÅ„
- **Ochrona bieÅ¼Ä…cej sesji**: Zabezpieczenie przed przypadkowym wylogowaniem
::

### Integracja z rolami uÅ¼ytkownikÃ³w

ZarzÄ…dzanie sesjami jest automatycznie dostÄ™pne dla wszystkich rÃ³l:

- **ADMIN/MANAGER**: PeÅ‚ny dostÄ™p + moÅ¼liwoÅ›Ä‡ monitorowania sesji innych uÅ¼ytkownikÃ³w
- **COACH**: Standardowy dostÄ™p + monitorowanie sesji swoich sportowcÃ³w  
- **ATHLETE/USER**: Standardowy dostÄ™p do zarzÄ…dzania wÅ‚asnymi sesjami
- **EDITOR/OBSERVER**: Podstawowy dostÄ™p do zarzÄ…dzania sesjami

### Implementacja techniczna

::code-group
```sql [Migracja bazy danych]
-- 0006_sharp_zuras.sql
ALTER TABLE refresh_tokens ADD COLUMN device_name TEXT;
ALTER TABLE refresh_tokens ADD COLUMN location TEXT;  
ALTER TABLE refresh_tokens ADD COLUMN is_current INTEGER DEFAULT false;
```

```typescript [API Endpoints]
// DostÄ™pne endpointy
GET    /api/auth/sessions      // Lista aktywnych sesji
DELETE /api/auth/sessions/[id] // UsuniÄ™cie sesji
POST   /api/auth/sessions/revoke // Grupowe zarzÄ…dzanie
```
::

**PeÅ‚na dokumentacja**: Zobacz szczegÃ³Å‚owy przewodnik w `/docs/development/session-management`

## ğŸ”— Integracja systemÃ³w

Wszystkie komponenty systemu zarzÄ…dzania uÅ¼ytkownikami wspÃ³Å‚pracujÄ… ze sobÄ…:

::mermaid
graph TD
    A[Rejestracja] --> B[Przypisanie roli]
    B --> C[Logowanie]
    C --> D[Utworzenie sesji]
    D --> E[ZarzÄ…dzanie sesjami]
    E --> F[Monitoring bezpieczeÅ„stwa]
    F --> G[Kontrola dostÄ™pu]
::

### PrzepÅ‚yw rejestracji i pierwszego logowania

1. **Rejestracja**: UÅ¼ytkownik tworzy konto lub jest dodany przez administratora
2. **Weryfikacja**: Opcjonalne potwierdzenie email (w zaleÅ¼noÅ›ci od konfiguracji)
3. **Pierwsze logowanie**: Automatyczne utworzenie pierwszej sesji
4. **Przypisanie roli**: DomyÅ›lnie `USER` lub rola okreÅ›lona przez administratora
5. **DostÄ™p do funkcji**: Uprawnienia zgodne z przypisanÄ… rolÄ…
6. **ZarzÄ…dzanie sesjami**: Natychmiastowy dostÄ™p do monitorowania sesji

---

::alert{type="warning"}
**Zalecenie bezpieczeÅ„stwa**: Regularnie monitoruj aktywne sesje swoich uÅ¼ytkownikÃ³w i zachÄ™caj ich do korzystania z funkcji zarzÄ…dzania sesjami, szczegÃ³lnie przy pracy z wraÅ¼liwymi danymi sportowymi.
::
